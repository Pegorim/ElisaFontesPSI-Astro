---
import Layout from '../../layouts/Layout.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import { getCollection, render } from 'astro:content';

export async function getStaticPaths() {
  const posts = await getCollection('blog');
  return posts.map((post) => ({
    params: { slug: post.id.replace(/\.md$/, '') },
    props: { post },
  }));
}

const { post } = Astro.props;
const { Content } = await render(post);

const formattedDate = post.data.pubDate.toLocaleDateString('pt-BR', {
  day: 'numeric',
  month: 'long',
  year: 'numeric',
});
---

<Layout
  title={`${post.data.title} | Elisa Fontes - Psicóloga`}
  description={post.data.description}
  image={post.data.image}
>
  <Header />

  <main class="bg-primary-bg px-6 md:px-12 lg:px-20 py-12">
    <article class="max-w-3xl mx-auto">
      <!-- Breadcrumb -->
      <nav class="mb-8">
        <a href="https://elisafontes.com.br/blog" class="text-text-main/70 hover:text-accent transition-colors">
          ← Voltar para o Blog
        </a>
      </nav>

      <!-- Article Header -->
      <header class="mb-8">
        <span class="inline-block bg-card-bg text-text-main text-sm font-medium px-4 py-1 rounded-sm mb-4">
          {post.data.category}
        </span>

        <h1 class="text-3xl md:text-4xl lg:text-5xl font-heading text-text-main mb-4 leading-tight">
          {post.data.title}
        </h1>

        <p class="text-text-main/70 text-lg mb-4">
          {post.data.description}
        </p>

        <div class="flex items-center gap-4 text-sm text-text-main/60">
          <span>Por Elisa Fontes</span>
          <span>•</span>
          <time datetime={post.data.pubDate.toISOString()}>
            {formattedDate}
          </time>
        </div>
      </header>

      <!-- Featured Image -->
      {post.data.image && (
        <div class="mb-10 rounded-lg overflow-hidden">
          <img
            src={post.data.image}
            alt={post.data.title}
            class="w-full h-auto"
          />
        </div>
      )}

      <!-- Article Content -->
      <div class="prose prose-lg max-w-none">
        <Content />
      </div>

      <!-- Author Box -->
      <aside class="mt-12 p-6 bg-card-bg rounded-lg">
        <div class="flex items-start gap-4">
          <img
            src="/images/profile.jpg"
            alt="Elisa Fontes"
            class="w-16 h-16 rounded-full object-cover"
          />
          <div>
            <p class="font-heading text-lg text-text-main mb-1">
              Elisa Fontes
            </p>
            <p class="text-sm text-text-main/70 mb-3">
              Psicóloga Clínica | CRP 05/72023
            </p>
            <p class="text-sm text-text-main/70">
              Especialista em ansiedade, autoestima e desenvolvimento pessoal.
              Atendimento online e presencial em Niterói, RJ.
            </p>
          </div>
        </div>
      </aside>

      <!-- CTA -->
      <div class="mt-12 text-center p-8 bg-card-bg rounded-lg">
        <h3 class="font-heading text-2xl text-text-main mb-4">
          Precisa de ajuda profissional?
        </h3>
        <p class="text-text-main/70 mb-6">
          Agende uma consulta e comece sua jornada de autoconhecimento.
        </p>
        <a
          href="https://elisafontes.com.br/contato"
          class="inline-block bg-accent text-white px-8 py-3 rounded-sm font-medium hover:bg-accent/90 transition-colors"
        >
          Agendar consulta
        </a>
      </div>
    </article>
  </main>

  <Footer />
</Layout>

<style is:global>
  .prose {
    color: var(--color-text-main);
  }

  .prose h2 {
    font-family: var(--font-heading);
    font-size: 1.75rem;
    font-weight: 600;
    margin-top: 2.5rem;
    margin-bottom: 1rem;
    color: var(--color-text-main);
  }

  .prose h3 {
    font-family: var(--font-heading);
    font-size: 1.35rem;
    font-weight: 600;
    margin-top: 2rem;
    margin-bottom: 0.75rem;
    color: var(--color-text-main);
  }

  .prose p {
    margin-bottom: 1.25rem;
    line-height: 1.8;
  }

  .prose ul, .prose ol {
    margin-bottom: 1.25rem;
    padding-left: 1.5rem;
  }

  .prose li {
    margin-bottom: 0.5rem;
    line-height: 1.7;
  }

  .prose ul li {
    list-style-type: disc;
  }

  .prose ol li {
    list-style-type: decimal;
  }

  .prose strong {
    font-weight: 700;
    color: var(--color-text-main);
  }

  .prose a {
    color: var(--color-accent);
    text-decoration: underline;
    transition: opacity 0.2s;
  }

  .prose a:hover {
    opacity: 0.8;
  }

  .prose blockquote {
    border-left: 4px solid var(--color-accent);
    padding-left: 1.5rem;
    margin: 1.5rem 0;
    font-style: italic;
    color: var(--color-text-main);
    opacity: 0.9;
  }

  .prose hr {
    border: none;
    border-top: 1px solid var(--color-card-bg);
    margin: 2rem 0;
  }

  .prose em {
    font-style: italic;
  }
</style>
